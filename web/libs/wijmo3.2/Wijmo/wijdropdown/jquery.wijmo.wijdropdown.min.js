var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(t){"use strict";var n=jQuery,r="wijdropdown",i=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype._setOption=function(t,n){var r=this,i=r.options.wijCSS;e.prototype._setOption.call(this,t,n),t==="disabled"&&(r._labelWrap.toggleClass(i.stateDisabled,n),r._label.toggleClass(i.stateDisabled,n),r.element.attr("disabled",n?"disabled":""))},t.prototype._create=function(){var e=this,t=e.element;window.wijmoApplyWijTouchUtilEvents&&(n=window.wijmoApplyWijTouchUtilEvents(n));if(t.get(0).tagName.toLowerCase()!=="select")return;t.is(":visible")?(e._activeItem=null,e._createSelect(),e._bindEvents(),e.needInit=!1):e.needInit=!0,e.element.is(":hidden")&&e.element.wijAddVisibilityObserver&&e.element.wijAddVisibilityObserver(function(){e.refresh(),e.element.wijRemoveVisibilityObserver&&e.element.wijRemoveVisibilityObserver()},"wijdropdown")},t.prototype._createSelect=function(){var e=this,t=e.options,r=e.options.wijCSS,i=e.element,s=i.width(),o=s,u=i.wrap("<div></div>").parent().addClass(r.helperHidden),a=u.wrap("<div></div>").parent().attr("role","select").addClass(r.wijdropdown).addClass(r.widget).addClass(r.stateDefault).addClass(r.cornerAll).addClass(r.helperClearFix),f=n("<label></label>").addClass(r.wijdropdownLabel).addClass(r.cornerAll).attr("id",i.get(0).id+"_select").attr("name",i.attr("name")||""),l=n("<div></div>").addClass(r.wijdropdownTrigger).addClass(r.stateDefault).addClass(r.cornerRight),c=n('<a href="#"></a>'),h=n("<div>").addClass(r.wijmodropdown),p=n("<ul></ul>").addClass(r.wijdropdownList).addClass(r.content).addClass(r.widget).addClass(r.cornerAll).addClass(r.helperReset).appendTo(h);n("<span></span>").addClass(r.icon).addClass(r.iconArrowDown).appendTo(l),s=Math.max(s,a.width()),i.get(0).tabIndex!==""&&c.attr("tabindex",i.attr("tabindex")),i.get(0).disabled!==!1&&(e.options.disabled=!0),e.options.disabled&&(c.addClass(r.stateDisabled),f.addClass(r.stateDisabled)),c.append(f),a.append(u).append(c).append(l),t.ensureDropDownOnBody?h.wrap(n("<div></div>").addClass(r.wijdropdown)).parent().appendTo("body").css("position","absolute"):a.append(h),o+=parseInt(f.css("padding-left").replace(/px/,""),10),o+=parseInt(f.css("padding-right").replace(/px/,""),10),o-=16,a.width(o),e._buildList(p,h,o),e._rightTrigger=l,e._label=f,e._listContainer=h,e._list=p,e._value=i.val(),e._selectedIndex=n("option",i).index(i.find("option:selected")),e._selectWrap=u,e._labelWrap=c,e._container=a,a.attr("title",i.attr("title")),i.removeAttr("title")},t.prototype._buildList=function(e,t,r){var i=this,s=i.options.wijCSS,o=i.element,u;t.show(),o.children().each(function(t,r){var o=n(r),u,a,f;return o.is("option")?e.append(i._buildItem(o)):(u=n("<li></li>").addClass(s.wijdropdownOptgroup),a=n("<span>"+o.attr("label")+"</span>").addClass(s.wijdropdownOptgroupHeader).addClass(s.priorityPrimary),f=n("<ul></ul>").addClass(s.helperReset).addClass(s.wijdropdownItems),o.children("option").each(function(){return f.append(i._buildItem(n(this))),this}),u.append(a).append(f),e.append(u)),this}),t.height(""),u=t.height(),u=e.outerHeight()<u?e.outerHeight():u,t.css({height:u,width:r}),n.browser.msie&&/^[8]\.[0-9]+/.test(n.browser.version)?e.setOutWidth(r-19):e.setOutWidth(r-18),t.data("wijmoWijsuperpanel")?(t.wijsuperpanel("paintPanel"),i.superpanel=t.data("wijmoWijsuperpanel")):i.superpanel=t.wijsuperpanel().data("wijmoWijsuperpanel"),n.fn.bgiframe&&i.superpanel.element.bgiframe(),i.superpanel.vNeedScrollBar||(n.browser.msie&&/^[8]\.[0-9]+/.test(n.browser.version)?e.setOutWidth(r-1):e.setOutWidth(r),i.superpanel.refresh()),t.hide()},t.prototype._handelEvents=function(e){var t=this,n=t.options.wijCSS,r="."+t.widgetName,i=t.element;e.bind("click"+r,function(n){if(t.options.disabled)return;t._listContainer.is(":hidden")?t._show():t._hide(),i.click(),e.get(0)===t._label.get(0)?n.preventDefault():t._labelWrap.focus()}).bind("mouseover"+r,function(){if(t.options.disabled)return;t._label.addClass(n.stateHover),t._rightTrigger.addClass(n.stateHover),i.trigger("mouseover")}).bind("mouseout"+r,function(){if(t.options.disabled)return;t._label.removeClass(n.stateHover),t._rightTrigger.removeClass(n.stateHover),i.trigger("mouseout")}).bind("mousedown"+r,function(){if(t.options.disabled)return;t._label.addClass(n.stateActive),t._rightTrigger.addClass(n.stateActive),i.trigger("mousedown")}).bind("mouseup"+r,function(){if(t.options.disabled)return;t._label.removeClass(n.stateActive),t._rightTrigger.removeClass(n.stateActive),i.trigger("mouseup")})},t.prototype._bindEvents=function(){var e=this,t=e.options.wijCSS,r="."+e.widgetName,i=e._label,s=e._rightTrigger,o=e._labelWrap,u=e._listContainer,a=e.element,f=!1,l;e._handelEvents(e._label),e._handelEvents(e._rightTrigger),n(window).bind("resize",function(t){e._setListContainerPosition()}),n(document).bind("mouseup"+r,function(n){if(u.is(":hidden")){i.removeClass(t.stateFocus),s.removeClass(t.stateFocus);return}l=u.offset();if(n.target===i.get(0)||n.target===s.get(0)||n.target===s.children().get(0))return;if(n.pageX<l.left||n.pageX>l.left+u.width()||n.pageY<l.top||n.pageY>l.top+u.height())i.removeClass(t.stateFocus),s.removeClass(t.stateFocus),e._hide()}),u.bind("click"+r,function(r){var i=n(r.target);i.closest("li."+t.wijdropdownItem,n(this).get(0)).length>0&&(e._setValue(),u.css("z-index",""),n.browser.msie&&/^[6,7].[0-9]+/.test(n.browser.version)&&u.parent().css("z-index",""),u.hide(),e._setValueToEle()),a.click()}),o.bind("keydown"+r,function(t){if(e.options.disabled)return;var r=n.ui.keyCode;switch(t.which){case r.UP:case r.LEFT:e._previous(),e._setValue(),e._setValueToEle();break;case r.DOWN:case r.RIGHT:e._next(),e._setValue(),e._setValueToEle();break;case r.PAGE_DOWN:e._nextPage(),e._setValue(),e._setValueToEle();break;case r.PAGE_UP:e._previousPage(),e._setValue(),e._setValueToEle();break;case r.ENTER:case r.NUMPAD_ENTER:e._setValue(),e._listContainer.hide(),e._setValueToEle()}t.which!==r.TAB&&t.preventDefault(),a.trigger("keydown")}).bind("focus"+r,function(){if(e.options.disabled)return;i.addClass(t.stateFocus),s.addClass(t.stateFocus),a.focus()}).bind("blur"+r,function(){if(e.options.disabled)return;i.removeClass(t.stateFocus),s.removeClass(t.stateFocus),a.trigger("blur")}).bind("keypress"+r,function(){if(e.options.disabled)return;a.trigger("keypress")}).bind("keyup"+r,function(){if(e.options.disabled)return;a.trigger("keyup")}),f=/chrome/.test(navigator.userAgent.toLowerCase());if(f||n.browser.safari)o.bind("click"+r,function(){o.focus()}),s.bind("mouseout"+r,function(){if(e.options.disabled)return;i.removeClass(t.stateFocus),s.removeClass(t.stateFocus)})},t.prototype._setListContainerPosition=function(){var e=this,t=e.options,n;if(!t.ensureDropDownOnBody)return;n=e._container.offset(),e._listContainer.parent().offset({left:n.left,top:n.top+e._container.outerHeight()})},t.prototype._init=function(){var e=this;e._initActiveItem(),e._activeItem&&e._label.text(e._activeItem.text())},t.prototype._buildItem=function(e){var t=e.val(),r=e.text(),i=this,s=i.options.wijCSS,o;return r===""&&(r="&nbsp;"),o=n("<li></li>").addClass(s.wijdropdownItem).addClass(s.cornerAll).append(n("<span>"+r+"</span>")).mousemove(function(e){var t=n(e.target).closest("."+s.wijdropdownItem);t!==this.last&&i._activate(n(this)),this.last=n(e.target).closest("."+s.wijdropdownItem)}).attr("role","option"),o.data("value",t),o},t.prototype._show=function(){var e=this,t=e._listContainer,r=e.options.showingAnimation;e._setListContainerPosition(),t.css("z-index","100000"),n.browser.msie&&/^[6,7]\.[0-9]+/.test(n.browser.version)&&t.parent().css("z-index","99999"),r?t.show(r.effect,r.options,r.speed,function(){e._initActiveItem()}):t.show()},t.prototype._hide=function(){var e=this,t=e._listContainer,r=e.options.hidingAnimation;if(t.is(":hidden"))return;r?t.hide(r.effect,r.options,r.speed,function(){n.isFunction(r.callback)&&r.callback.apply(e,arguments),n.browser.msie&&/^[6,7]\.[0-9]+/.test(n.browser.version)&&t.parent().css("z-index",""),t.css("z-index","")}):(n.browser.msie&&n.browser.version==="6.0"&&t.parent().css("z-index",""),t.css("z-index",""),t.hide())},t.prototype._setValue=function(){var e=this,t=e.options.wijCSS,r=e._listContainer,i,s;e._activeItem&&(e._label.text(e._activeItem.text()),e._value=e._activeItem.data("value"),e._selectedIndex=n("li."+t.wijdropdownItem,r).index(e._activeItem),e.superpanel.vNeedScrollBar&&(i=e._activeItem.offset().top,s=e._activeItem.outerHeight(),r.offset().top>i?r.wijsuperpanel("scrollTo",0,i-e._list.offset().top):r.offset().top<i+s-r.innerHeight()&&r.wijsuperpanel("scrollTo",0,i+s-r.height()-e._list.offset().top)))},t.prototype._setValueToEle=function(){var e=this,t=e.element,r=t.find(":selected"),i=n("option",t).index(r),s=e._selectedIndex;i!==s&&(n.browser.mozilla&&t.val(e._value),r.removeAttr("selected"),t.find("option:eq("+s+")").prop("selected",!0),t.trigger("change"))},t.prototype._initActiveItem=function(){var e=this,t=e.options.wijCSS;if(e._value!==undefined){if(e._selectedIndex===-1){e._activate(e._list.find("li."+t.wijdropdownItem).eq(0));return}e._list.find("li."+t.wijdropdownItem).each(function(t){if(t===e._selectedIndex)return e._activate(n(this)),!1})}},t.prototype._activate=function(e){var t=this,n=t.options.wijCSS;t._deactivate(),t._activeItem=e,t._activeItem.addClass(n.stateHover).attr("aria-selected",!0)},t.prototype._deactivate=function(){var e=this,t=e.options.wijCSS;e._activeItem&&e._activeItem.removeClass(t.stateHover).attr("aria-selected",!1)},t.prototype._next=function(){this._move("next","first")},t.prototype._previous=function(){this._move("prev","last")},t.prototype._nextPage=function(){this._movePage("first")},t.prototype._previousPage=function(){this._movePage("last")},t.prototype.refresh=function(){var e=this,t=e.options.wijCSS,r=e.element,i;if(e.needInit)e.element.is(":visible")&&(e._activeItem=null,e._createSelect(),e._bindEvents(),e._init(),e.needInit=!1);else{if(!e._list)return;e._listContainer.show(),e._selectWrap.removeClass(t.helperHidden),i=e.element.width(),i+=parseInt(e._label.css("padding-left").replace(/px/,""),10),i+=parseInt(e._label.css("padding-right").replace(/px/,""),10),i-=16,e._container.width(i),e._selectWrap.addClass(t.helperHidden),e._list.empty(),e._buildList(e._list,e._listContainer,i),e._value=e.element.val(),e._selectedIndex=n("option",r).index(r.find("option:selected")),e._initActiveItem(),e._activeItem&&e._label.text(e._activeItem.text())}},t.prototype._move=function(e,t){var n=this,r=n.options.wijCSS,i,s;if(!n._activeItem){n._activate(n._list.find("."+r.wijdropdownItem+":"+t));return}i=n._activeItem[e]().eq(0),i.length?s=n._getNextItem(i,e,t):n._activeItem.closest("."+r.wijdropdownOptgroup).length&&(s=n._getNextItem(n._activeItem.closest("."+r.wijdropdownOptgroup)[e](),e,t)),s&&s.length?n._activate(s):n._activate(n._list.find("."+r.wijdropdownItem+":"+t))},t.prototype._movePage=function(e){var t=this,r=t.options.wijCSS,i,s,o,u=e==="first"?"last":"first";t.superpanel.vNeedScrollBar?(i=t._activeItem.offset().top,s=t.options.height,o=t._list.find("."+r.wijdropdownItem).filter(function(){var t=n(this).offset().top-i+(e==="first"?-s:s)+n(this).height(),r=n(this).height();return t<r&&t>-r}),o.length||(o=t._list.find("."+r.wijdropdownItem+":"+u)),t._activate(o)):t._activate(t._list.find("."+r.wijdropdownItem+":"+(t._activeItem?u:e)))},t.prototype._getNextItem=function(e,t,n){var r=this.options.wijCSS;if(e.length){if(!e.is("."+r.wijdropdownOptgroup))return e;if(!!e.find(">ul>li."+r.wijdropdownItem).length)return e.find(">ul>li."+r.wijdropdownItem+":"+n).eq(0);this._getNextItem(e[t]().eq(0))}},t.prototype.destroy=function(){var t=this,n=t.options.wijCSS;this.element.attr("title",this._container.attr("title")),this.element.closest("."+n.wijdropdown).find(">div."+n.wijdropdownTrigger+",>div."+n.wijmodropdown+",>a").remove(),this._listContainer.remove(),this.element.unwrap().unwrap().removeData("maxZIndex"),e.prototype.destroy.call(this)},t}(e.wijmoWidget);t.wijdropdown=i;var s=function(){function e(){this.initSelector=":jqmData(role='wijdropdown')",this.wijCSS={wijmodropdown:"wijmo-dropdown",wijdropdown:"wijmo-wijdropdown",wijdropdownLabel:"wijmo-dropdown-label",wijdropdownTrigger:"wijmo-dropdown-trigger",wijdropdownList:"wijmo-dropdown-list",wijdropdownOptgroup:"wijmo-dropdown-optgroup",wijdropdownOptgroupHeader:"wijmo-optgroup-header",wijdropdownItems:"wijmo-dropdown-items",wijdropdownItem:"wijmo-dropdown-item"},this.zIndex=1e3,this.showingAnimation={effect:"blind"},this.hidingAnimation={effect:"blind"},this.ensureDropDownOnBody=!1}return e}();i.prototype.options=n.extend(!0,{},e.wijmoWidget.prototype.options,new s),n.wijmo.registerWidget(r,i.prototype)})(e.dropdown||(e.dropdown={}));var t=e.dropdown})(wijmo||(wijmo={}));